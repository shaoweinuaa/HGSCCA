function [H,Lh] = cons_hypergraph(X,k)
m = size(X,1);
H = zeros(m,m);    %H?incidence matrix;
for j = 1:m              %??KNN?????????????????K????????
    z = knnsearch(X,X(j,:),'K',k);  %knn??K????De?????
    for i = 1:k
         H(z(i),j) = 1;
    end
end
A = eye(m);    % A?hyperedge weights??????????????1?
Dv = zeros(m,m);   %Dv??????????????
tmp1 = sum(H'*A,2);
for i = 1:m
    Dv(i,i) = tmp1(i);
end
De = k*eye(m);  %De??????????????
theta1 = (Dv^-0.5)*H*A*(De^-1)*H'*(Dv^-0.5);
I = eye(m);
Lh = I - theta1;    % LapLacian matrix;